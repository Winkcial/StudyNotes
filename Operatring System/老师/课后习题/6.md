# 第六章

## T2 文件系统模型可以分为三层，试说明其每一层所包含的基本内容

- 自下而上分别是：对象及属性、对对象操纵和管理的软件集合、文件系统接口
- 对象及属性：对象：文件、目录、磁盘储存空间
- 对对象操纵和管理的软件集合：文件系统的核心
- 文件系统的接口：命令接口、程序接口

## T7 试从索引速度和存储费用两方面来比较两级索引文件和索引顺序文件？

- 两级索引文件：存储费用高，检索速度较快。
- 索引顺序文件：存储费用不高，检索速度快。

## T9 在链接式文件中常用哪种链接方式？为什么？

- 在链接式文件中常采用显示链接法
- 由于这种链接方式把用于链接文件各个物理块的指针，显式地存放在内存的一张链表中，而对于查找记录的过程也是在内存中进行的
- 因此相对于隐式链接方式，在检索记录时能有效地调高检索速度，并能大大减少访问磁盘的次数节省系统开销。

## T10 在 MS-DOS 中有两个文件 A  和 B ，A 占用 11、12、16 和 14 四个盘快，B 占用 13 18 和 20 三个盘块。试画出文件 A 和 B 中各盘块间的链接情况。

## T11 NTFS 系统对文件采用什么样的物理结构？

- 在NTFS 文件系统中，以簇作为磁盘空间分配和回收的基本单位。
- 一个文件占若干个簇，一个簇只属于一个文件。

## T12假定一个文件系统的组织方式与MS-DOS相似，在FAT中可有64K个指针，磁盘的盘块大小为512B，试问该文件系统能否指引一个512MB 的磁盘？
解：512MB/512B=1M 个盘块，而每个盘块都应有一个指针来指示，所以应该有1M 个指针，因此若有64K 指针不能指引一个512MB的磁盘。

## T14

在UNIX 中，如果一个盘块的大小为1KB，每个盘块号占4个字节，即每块可放256个地址。请转换下列文件的字节偏移量为物理地址。
⑴9999； ⑵18000； ⑶420000

## T15 什么是索引文件？为什么要引入索引文件？

索引文件是指当记录为可变长度时，通常为之建立一张索引表，并为每个记录设置一个表项构成的文件。通常将索引非顺序文件简称为索引文件。索引是为了是用户的访问速度更快，多级索引结构可以有效的管理索引文件，可根据用户的访问情况多级处理。

## T16 对目录管理的主要要求是什么？

实现按名存取、提高检索目录的速度、文件共享、允许文件重名。

## T19 目前广泛采用的目录结构是什么？它有什么优点？

现代操作系统都采用多级目录结构。基本特点是查询速度快、层次结构清晰、文件管理和保护易于实现。

在Hash法查找目录时，如果目录表中相应目录项为空，表示系统中无指定文件。如果文件名与指定文件名匹配，表示找到了目标文件，也就找到了文件的物理地址。如果目录表中找到的相应文件名不匹配，则发生了冲突，需要Hash转换形成新的索引值，返回第一步重新查找。

## T23

## T24

## T25对空闲磁盘空间的管理常采用哪几种分配方式？在UNIX系统中采用何种分配方式？

空闲表法、空闲链表法、位示图法、成组链接法。UNIX系统采用的是成组链接法

## 27．基于符号链的文件共享方式有何优点？
答：能够通过网络链接世界上 任何地方的计算机中的文件。

## 30何谓事务？如何保证事务的原子性？

答：事务是用于访问和修改各种数据项的一个程序单位。
要保证事务的原子性必须要求一个事务在对一批数据执行修改操作时，要么全部完成，
用修改后的数据代替原来数据，要么一个也不改，保持原来数据的一致性。



## 31引入检查点的目的是什么？引入检查点后又如何进行恢复处理？
答：引入检查点的目的是使对事务记录表中事务记录的清理工作经常化。
恢复处理由恢复例程来实现。首先查找事务记录表，确定在最近检查点以前开始执行的
最后的事务Ti。找到Ti后再返回搜索事务记录表，找到第一个检查点记录，从该检查点开
始，返回搜索各个事务记录，利用redo和undo 过程对他们进行相应的处理。

## T34 如何检索盘块号？检查时可能出现哪几种情况？

为了保证盘块号的一致性，先将计数器表中的所有表项初始化为0，用N 个空闲盘块

号计数器组成的第一组计数器对从空闲盘块表中读出的盘块号计数，用N 个数据盘块号计
数器组成的第二组计数器对从文件分配表中读出的已分配给文件使用的盘快号计数。如果两组计数中的对应数据互补则数据一致，反之则发生错误。
检查时可能出现的情况：
（1）两组计数器中盘块K 的计数值均为0，应在空闲盘块表中增加盘块号K；
（2）空闲盘块号计数器中盘块K 的计数值为2，应删除一个空闲盘块号K；
（3）空闲盘块号计数器中盘块号K 的计数值为0，而数据盘块号计数器中盘块号K 的
计数值大于1，则错误严重，存在数据丢失等事件，必须立即报告系统加以处理。
