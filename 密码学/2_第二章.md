# 古典密码

## 1. 古典密码中的基本加密运算

- 加法密码
- 乘法密码
- 仿射密码

**加法密码**

设 $X=Y=Z_q$ ，$K=Z_q$ 对于任意的 $m\in X,\,k\in K$ 相应的密文

$$
c=E_k(m)=(m+k)\,mod\,\,q
$$

加密算法的密钥量为 q

**乘法密码**

设 $X=Y=Z_q$ ，$K=Z_q^{*}$ 对于任意的 $m\in X,\,k\in K$ 相应的密文

$$
c=E_k(m)=km\,mod\,\,q
$$

乘法密码的解密变换

$$
m=k^{-1}c\,mod\,\,1
$$

密钥量 $\varphi(q)$

**仿射密码**

设 $X=Y=Z_q,\,K=\{(k_1,\,k_2)|k_1\in Z_q,\,k_2\in Z_q^{*}\}$ 对任意的 $m\in X$ $k=(k_1,\,k_2)\in K$ 相应的密文

$$
c=E_k(m)=(k_1+k_2m)\,mod\,\,q
$$

解密变换

$$
m=k_2^{-1}(c-k_1)\,mod\,\,q
$$

密钥量 $q\varphi(q)$

## 2. 几种典型的古典密码体制

- Caesar 体制
- Vigenere 体制
- Veranam 体制
- Hill 体制

**Caesar 体制**

过于简单

**Vigenere 体制**

设明文 $m=m_1m_2\cdots m_n$ 密钥 $k=k_1k_2\cdots k_s$ 则密文为 

$$
c=E_k(m)=c_1c_2\cdots c_n
$$

其中 $c_i=(m_i+k_i)\,mod\,\,26,\,i=1,2,\cdots,n$ 当密钥的长度比明文短时，密钥重复使用

当用密钥字 $k_i$ 对明文字 $m_i$ 加密时，Vigenere 方阵中的第 $K_i$ 行第 $m_i$ 列的字母就是加密后的密文

**Vernam 体制**

明文为 0 或 1 的字符串

设 $m=m_1m_2\cdots m_i\cdots$ 为明文，$k=k_1k_2\cdots k_i\cdots$ 为密钥，其中 $m_i,\,k_i\in GF(2),\,i\ge1$ 则密文为

$$
c=c_1c_2\cdots c_i\cdots
$$

其中 $c_i=m_i\oplus c_i,\,\,i\ge1$

**Hill 体制**

- 明文 $m=(m_1,m_2,\cdots,m_n)\in Z_{26}^n$ 
- 密文 $c=(c_1,c_2,\cdots,c_n)\in Z_{26}^n$
- 密钥 $Z_{26}$ 上的 $n\times n$ 阶可逆方阵 $K=(k_{ij})_{n\times n}$

相应的密文

$$
c=mK\,mod\,\,26
$$

解密变换

$$
m=cK^{-1}\,mod\,\,26
$$

设 $n=2$ 密钥为

$$
K=\left( \begin{matrix}
	11&		8\\
	3&		7\\
\end{matrix} \right) 
$$

逆矩阵

$$
K^{-1}=\left( \begin{matrix}
	7&		18\\
	23&		11\\
\end{matrix} \right) 
\\
$$
设明文为 Hill，则相应的明文向量为 $(7,8)$ 和 $(11,11)$ 于是相应的密文向量分别是

$$
\left( 7,8 \right) \left( \begin{matrix}
	11&		8\\
	3&		7\\
\end{matrix} \right) =\left( 77+24,56+56 \right) =\left( 23,8 \right) 
$$

$$
\left( 11,11 \right) \left( \begin{matrix}
	11&		8\\
	3&		7\\
\end{matrix} \right) =\left( 121+33,88+77 \right) =\left( 24,9 \right)
$$

因此，明文 Hill 对应的密文为 